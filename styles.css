/* ── RESET + TOKENS ── */
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#07070f;--surface:#10101e;--border:#252538;
  --gold:#c8a044;--text:#b0a898;--dim:#4a4560;
  --chaos:#ff3a50;--entropy:#44ffaa;
  --green:#44dd88;--red:#ff4455;
}
body{background:var(--bg);color:var(--text);font-family:Georgia,serif;
     height:100vh;display:flex;flex-direction:column;overflow:hidden;user-select:none}

/* ── TOPBAR ── */
#topbar{display:flex;align-items:center;justify-content:space-between;
        padding:7px 16px;border-bottom:1px solid var(--border);
        background:var(--surface);flex-shrink:0;gap:10px;flex-wrap:wrap}
.title{font-size:1em;letter-spacing:.4em;color:var(--gold);text-transform:uppercase}
.stats{display:flex;gap:14px;font-size:.8em;align-items:center;flex-wrap:wrap}
.stat{display:flex;align-items:center;gap:4px}
.sicon{color:var(--gold)}.sval{color:#fff;font-weight:bold}
.threat{font-size:.75em;padding:2px 8px;border-radius:3px;
        background:rgba(255,58,80,.1);border:1px solid rgba(255,58,80,.25);color:#ff8090}
.threat.hidden{display:none}
.boss-warn{font-size:.72em;padding:2px 8px;border-radius:3px;
           background:rgba(200,160,68,.12);border:1px solid rgba(200,160,68,.4);
           color:var(--gold);display:none}
.polmeter{display:flex;align-items:center;gap:5px;font-size:.75em;cursor:default}
.poltrack{width:52px;height:4px;background:var(--border);border-radius:3px;overflow:hidden}
.polfill{height:100%;border-radius:3px;transition:width .4s,background .4s}
.pollabel{color:var(--dim);min-width:26px;font-size:.9em;cursor:default}
.polbonus{color:var(--gold);font-size:.85em;cursor:default}
.pill{padding:2px 9px;border-radius:20px;font-size:.65em;
      letter-spacing:.12em;text-transform:uppercase;font-weight:bold}
.pill-shop  {background:rgba(200,160,68,.12);color:var(--gold);border:1px solid rgba(200,160,68,.4)}
.pill-combat{background:rgba(255,58,80,.12);color:var(--chaos);border:1px solid rgba(255,58,80,.4)}
.pill-result{background:rgba(68,255,170,.1);color:var(--entropy);border:1px solid rgba(68,255,170,.3)}

/* ── MAIN ── */
#main{flex:1;display:flex;flex-direction:column;padding:9px 13px;gap:5px;overflow:hidden}
.blabel{font-size:.63em;letter-spacing:.2em;color:var(--dim);
        text-transform:uppercase;margin-bottom:3px}
.board{display:flex;gap:7px;align-items:flex-end;min-height:114px;flex-wrap:wrap}
.slot{width:82px;height:108px;border:1px dashed var(--border);border-radius:6px;
      display:flex;align-items:center;justify-content:center;
      color:var(--dim);font-size:.65em}

/* ── UNIT CARDS ── */
.ucard{width:82px;min-height:108px;background:var(--surface);
       border:1px solid var(--border);border-radius:6px;
       display:flex;flex-direction:column;align-items:center;
       padding:6px 4px 5px;position:relative;overflow:hidden;
       transition:border-color .15s,transform .12s}
.ucard.targeted {border-color:var(--red)}
.ucard.dead     {opacity:.2;filter:grayscale(1)}
.ucard.selectable{border-color:var(--gold);
                   box-shadow:0 0 9px rgba(200,160,68,.45);cursor:pointer}
.ucard.selectable:hover{box-shadow:0 0 16px rgba(200,160,68,.65)}
.ucard.lv2{border-color:rgba(200,160,68,.5)}
@keyframes flashRed{0%{background:rgba(255,60,80,.45)}100%{background:transparent}}
.ucard.flash{animation:flashRed .5s ease-out}

/* Attack clarity — player vs enemy attacker visually distinct */
.ucard.player-attacking{border-color:var(--entropy);
  box-shadow:0 0 10px rgba(68,255,170,.35);transform:scale(1.07);z-index:2}
.ucard.enemy-attacking {border-color:var(--chaos);
  box-shadow:0 0 10px rgba(255,58,80,.25);transform:scale(1.07);z-index:2}

/* Reorder selection */
.ucard.reorder-sel{border-color:var(--gold);
  box-shadow:0 0 12px rgba(200,160,68,.5);cursor:crosshair}

.uimg{width:48px;height:48px;image-rendering:pixelated;margin-bottom:2px}
.usym{font-size:1.7em;line-height:1;margin-bottom:2px}
.uname{font-size:.56em;letter-spacing:.02em;color:var(--dim);
       text-align:center;margin-bottom:2px}
.ustats{display:flex;gap:5px;font-size:.74em}
.uatk{color:var(--chaos);cursor:default}
.uhp{color:var(--green);cursor:default}.uhp.dmg{color:#ffcc44}
.ulv{font-size:.48em;color:var(--gold);letter-spacing:.06em;margin-top:1px;cursor:default}
.ulv-ph{height:9px} /* placeholder keeps card height uniform when no lv badge */
.xpdots{font-size:.44em;color:var(--gold);margin-top:1px;cursor:default}
.ukw{font-size:.5em;font-weight:bold;padding:1px 4px;border-radius:3px;
     margin-top:2px;letter-spacing:.03em;cursor:default}
.ukw-ph{height:17px} /* placeholder keeps card height uniform when no keyword */
.kw-taunt    {background:rgba(58,111,255,.18);color:#6699ff;border:1px solid rgba(58,111,255,.3)}
.kw-haste    {background:rgba(255,200,68,.13);color:var(--gold);border:1px solid rgba(255,200,68,.28)}
.kw-retaliate{background:rgba(255,58,80,.13);color:#ff8090;border:1px solid rgba(255,58,80,.28)}
.kw-leech    {background:rgba(68,255,170,.1);color:var(--entropy);border:1px solid rgba(68,255,170,.22)}
.polbar{position:absolute;bottom:0;left:0;right:0;height:3px;cursor:default}
.hpbar{position:absolute;bottom:3px;left:4px;right:4px;height:2px;
       background:#181828;border-radius:1px}
.hpfill{height:100%;border-radius:1px;transition:width .3s}
.entbadge{position:absolute;top:2px;right:2px;background:var(--entropy);
          color:#020f06;font-size:.52em;font-weight:bold;width:12px;height:12px;
          border-radius:50%;display:flex;align-items:center;justify-content:center;
          cursor:default;z-index:3}
.orderbadge{position:absolute;top:2px;left:2px;background:var(--surface);
            border:1px solid var(--border);color:var(--dim);font-size:.48em;
            font-weight:bold;width:12px;height:12px;border-radius:50%;
            display:flex;align-items:center;justify-content:center;cursor:default}
.sellbtn{position:absolute;bottom:17px;left:2px;font-size:.48em;color:var(--chaos);
         border:1px solid var(--chaos);border-radius:2px;padding:1px 3px;
         cursor:pointer;background:var(--bg);opacity:0;transition:opacity .2s;z-index:2}
.ucard:hover .sellbtn{opacity:1}

/* ── LOG BAR ── */
#logbar{background:var(--surface);border:1px solid var(--border);
        border-radius:4px;overflow:hidden;flex-shrink:0;display:none;
        transition:border-color .2s}
#logbar.pturn{border-color:rgba(68,255,170,.4)}
#logbar.eturn{border-color:rgba(255,58,80,.35)}
#loginner{display:flex;align-items:center;gap:9px;padding:6px 11px;font-size:.77em}
.logtext{flex:1}
.logtag{color:var(--dim);font-size:.8em;letter-spacing:.1em;
        text-transform:uppercase;white-space:nowrap}
#timertrack{height:2px;background:var(--border)}
#timerfill{height:100%;background:var(--gold);width:0%;transition:none}

/* ── BOTTOM / SHOP ── */
#bottom{flex-shrink:0;padding-top:5px;border-top:1px solid var(--border)}
#shop{display:flex;gap:7px;align-items:flex-start;flex-wrap:wrap}
.sunit{width:82px;background:var(--surface);border:1px solid var(--border);
       border-radius:6px;padding:6px 4px 5px;cursor:pointer;text-align:center;
       transition:border-color .15s}
.sunit:hover:not(.unafford){border-color:var(--gold)}
.sunit.unafford{opacity:.42;cursor:not-allowed}
.scost{font-size:.68em;color:var(--gold);margin-top:2px}
.shoppolrow{display:flex;align-items:center;gap:3px;margin-top:2px;cursor:default}
.shoppolbar{flex:1;height:3px;border-radius:2px}
.shoppollabel{font-size:.48em;color:var(--dim)}
.simg{width:40px;height:40px;image-rendering:pixelated;margin-bottom:2px}
.shop-actions{display:flex;flex-direction:column;gap:5px;
              margin-left:auto;align-items:flex-end;min-width:90px}
.bonus-note{font-size:.63em;color:var(--gold);cursor:default}
.tier-note{font-size:.6em;color:var(--dim)}
.btn{padding:5px 12px;border:1px solid var(--border);background:var(--surface);
     color:var(--text);font-family:Georgia,serif;font-size:.76em;cursor:pointer;
     letter-spacing:.04em;transition:border-color .15s,color .15s;border-radius:3px}
.btn:hover{border-color:var(--gold);color:var(--gold)}
.btn.primary{border-color:rgba(200,160,68,.5);color:var(--gold)}
.btn.primary:hover{background:rgba(200,160,68,.08)}
.btn:disabled{opacity:.35;cursor:not-allowed;pointer-events:none}

/* ── ARM SECTION (shop phase) ── */
.arm-section{display:flex;gap:7px;align-items:flex-start;flex-wrap:wrap;
             padding-top:7px;margin-top:5px;
             border-top:1px solid var(--border);width:100%}
.arm-label{font-size:.6em;letter-spacing:.12em;color:var(--dim);
           text-transform:uppercase;align-self:center;min-width:64px;line-height:1.6}
.arm-note{color:rgba(68,255,170,.5);font-size:.9em;letter-spacing:0;
          text-transform:none;display:block}

/* ── CONDUCTOR PANEL ── */
#conductor{display:flex;gap:7px;align-items:flex-start}
.clabel{display:flex;flex-direction:column;gap:3px;justify-content:center;min-width:86px}
.clabel-title{font-size:.63em;letter-spacing:.14em;color:var(--dim);text-transform:uppercase}
.clabel-note{font-size:.6em;color:var(--dim);line-height:1.4}
.clabel-note.active{color:var(--gold)}
.clabel-note.window{color:var(--entropy)}
.ccard{width:92px;background:var(--surface);border:1px solid #2a2a44;
       border-radius:6px;padding:6px;cursor:pointer;
       transition:border-color .15s,box-shadow .15s;text-align:center}
.ccard:hover:not(.cused){border-color:var(--gold)}
.ccard.csel{border-color:var(--gold);box-shadow:0 0 10px rgba(200,160,68,.35)}
.ccard.cused{opacity:.4;cursor:not-allowed}
.ccard.cwindow:not(.cused){border-color:rgba(68,255,170,.5);
                            box-shadow:0 0 8px rgba(68,255,170,.2)}
.ccard.armed{border-color:rgba(68,255,170,.45);
             box-shadow:0 0 7px rgba(68,255,170,.18);
             cursor:default;pointer-events:none}
.cimg{width:40px;height:40px;image-rendering:pixelated;margin-bottom:2px}
.csym{font-size:1.25em;display:block;margin-bottom:2px;color:var(--gold)}
.cname{font-size:.63em;color:#fff;font-weight:bold;display:block;margin-bottom:2px}
.cdesc{font-size:.53em;color:var(--dim);line-height:1.3}

/* ── HOLD BUTTONS ── */
.hold-wrap{display:flex;flex-direction:column;gap:5px;
           justify-content:center;min-width:82px}
.hold-btn{font-size:.62em;padding:4px 8px;white-space:nowrap;text-align:center}

/* ── OVERLAYS ── */
#overlay,#tutorial,#levelup{
  position:fixed;inset:0;background:rgba(7,7,15,.9);
  display:none;flex-direction:column;align-items:center;
  justify-content:center;gap:14px;z-index:100}
.rtitle{font-size:1.8em;letter-spacing:.3em;text-transform:uppercase}
.rtitle.win {color:var(--gold)}
.rtitle.loss{color:var(--chaos)}
.rtitle.draw{color:var(--dim)}
.rsub{font-size:.8em;color:var(--dim);text-align:center;max-width:300px;line-height:1.7}

/* ── TUTORIAL ── */
.tbox{background:var(--surface);border:1px solid var(--border);
      border-radius:8px;padding:26px 30px;max-width:420px;
      display:flex;flex-direction:column;gap:13px}
.tstep{font-size:.6em;letter-spacing:.22em;text-transform:uppercase;color:var(--dim)}
.ttitle{font-size:1.2em;color:var(--gold);letter-spacing:.07em}
.tbody{font-size:.78em;color:var(--text);line-height:1.8}
.tbody strong{color:#fff}
.kw-inline{font-size:.85em;font-weight:bold;padding:1px 5px;border-radius:3px}
.tfoot{display:flex;justify-content:space-between;align-items:center;margin-top:4px}
.tdots{display:flex;gap:5px}
.tdot{width:6px;height:6px;border-radius:50%;background:var(--border)}
.tdot.active{background:var(--gold)}

/* ── LEVEL-UP ── */
.lubox{background:var(--surface);border:1px solid var(--gold);
       border-radius:8px;padding:26px 30px;max-width:340px;
       display:flex;flex-direction:column;align-items:center;gap:14px}
.lutitle{font-size:1em;letter-spacing:.3em;text-transform:uppercase;color:var(--gold)}
.lusub{font-size:.78em;color:var(--dim);text-align:center}
.luchoices{display:flex;gap:12px}
.luchoice{width:110px;background:var(--bg);border:1px solid var(--border);
          border-radius:6px;padding:12px 8px;cursor:pointer;text-align:center;
          transition:border-color .15s}
.luchoice:hover{border-color:var(--gold)}
.luchoice-icon{font-size:1.6em;margin-bottom:5px}
.luchoice-label{font-size:.7em;color:var(--gold);font-weight:bold}
.luchoice-desc{font-size:.6em;color:var(--dim);margin-top:2px}

/* ── FLOATING TOOLTIP ── */
/* Lives on <body> directly — never clipped by overflow:hidden on cards. */
#tooltip{display:none;position:fixed;background:#12121f;
         border:1px solid var(--border);color:var(--text);
         font-family:Georgia,serif;font-size:.68em;line-height:1.55;
         padding:5px 9px;border-radius:4px;max-width:220px;
         z-index:9999;pointer-events:none;box-shadow:0 2px 8px rgba(0,0,0,.5)}