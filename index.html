<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CONDUCTOR</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- TOPBAR -->
<div id="topbar">
  <div class="title">Conductor</div>
  <div class="stats">
    <div class="stat"><span class="sicon">â™¥</span><span class="sval" id="shp">30</span></div>
    <div class="stat"><span class="sicon">â—ˆ</span><span class="sval" id="srd">Round 1</span></div>
    <div class="stat" id="sgwrap">
      <span class="sicon">ðŸª™</span><span class="sval" id="sgold">3</span>
    </div>
    <div class="stat" id="sinsight-wrap" style="display:none">
      <span class="sicon" style="color:var(--entropy)">â—ˆ</span>
      <span class="sval"  id="sinsight"  style="color:var(--entropy)">0</span>
    </div>
    <div class="stat" id="sheat-wrap" style="display:none">
      <span class="sicon" style="color:var(--chaos)">ðŸ”¥</span>
      <span class="sval"  id="sheat"     style="color:var(--chaos)">0</span>
    </div>
    <div class="threat hidden" id="threat">
      âš” If you lose: <span id="threatval">0</span> dmg
    </div>
    <div class="boss-warn" id="bosswarn"></div>
    <div class="polmeter" id="polmeter" style="display:none">
      <span style="font-size:.7em;color:var(--dim)">Board:</span>
      <div class="poltrack"><div class="polfill" id="polfill"></div></div>
      <span class="pollabel" id="pollabel">â€”</span>
      <span class="polbonus" id="polbonus"></span>
    </div>
  </div>
  <div class="pill pill-shop" id="sphase">Shop</div>
</div>

<!-- MAIN -->
<div id="main">
  <div>
    <div class="blabel" id="opp-label">Opponent</div>
    <div class="board" id="eboard"></div>
  </div>
  <div id="logbar">
    <div id="timertrack"><div id="timerfill"></div></div>
    <div id="loginner">
      <span class="logtext" id="ltext">â€”</span>
      <span class="logtag"  id="ltag"></span>
    </div>
  </div>
  <div>
    <div class="blabel" id="board-label">Your Board</div>
    <div class="board" id="pboard"></div>
  </div>
  <div id="bottom">
    <div id="shop"></div>
    <div id="conductor" style="display:none"></div>
  </div>
</div>

<!-- RESULT OVERLAY -->
<div id="overlay">
  <div class="rtitle" id="rtitle"></div>
  <div class="rsub"   id="rsub"></div>
  <button class="btn primary" id="rbtn">Continue</button>
  <button class="btn"         data-action="restart">â†º New Run</button>
</div>

<!-- LEVEL-UP OVERLAY -->
<div id="levelup">
  <div class="lubox">
    <div class="lutitle">â¬¡ Unit Levelled Up</div>
    <div class="lusub" id="luname"></div>
    <div class="luchoices">
      <div class="luchoice" id="lu-atk">
        <div class="luchoice-icon">âš”</div>
        <div class="luchoice-label">+1 ATK</div>
        <div class="luchoice-desc">Strike harder</div>
      </div>
      <div class="luchoice" id="lu-hp">
        <div class="luchoice-icon">â™¥</div>
        <div class="luchoice-label">+1 HP</div>
        <div class="luchoice-desc">Endure longer</div>
      </div>
    </div>
  </div>
</div>

<!-- TUTORIAL OVERLAY -->
<div id="tutorial">
  <div class="tbox">
    <div class="tstep"  id="tstep"></div>
    <div class="ttitle" id="ttitle"></div>
    <div class="tbody"  id="tbody"></div>
    <div class="tfoot">
      <div class="tdots" id="tdots"></div>
      <button class="btn primary" id="tnext">Next â†’</button>
    </div>
  </div>
</div>

<!-- BOOTSTRAP -->
<script type="module">
  import { initStarterBoard, resetGame } from './state.js';
  import { startRound }                  from './shop.js';
  import { initTutorial }                from './tutorial.js';
  import { render, initEvents }          from './render.js';
  import { onContinue, applyLevelUp }    from './flow.js';

  function onRestart() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('levelup').style.display = 'none';
    resetGame();
    startRound();
    // Tutorial intentionally skipped on restart
  }

  initStarterBoard();
  startRound();
  initTutorial();
  initEvents({ onContinue, applyLevelUp, onRestart });
</script>
</body>
</html>